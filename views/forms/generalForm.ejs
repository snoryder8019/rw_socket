<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title><%= title %></title>
  <style>
    .array-field, .object-field {
      margin-bottom: 10px;
    }
  </style>
</head>
<body>
  <h1><%= title %></h1>
  <!-- Dynamically bring the model keys as inputs -->
  <form action="<%= action %>" method="post" enctype="multipart/form-data">
    <% formFields.forEach(field => { %>
      <div>
        <label for="<%= field.name %>"><%= field.label %>:</label>
        <% if (field.type === 'textarea') { %>
          <textarea name="<%= field.name %>" id="<%= field.name %>"><%= field.value %></textarea>
        <% } else if (field.type === 'file') { %>
          <input type="file" name="<%= field.name %>" id="<%= field.name %>">
        <% } else if (field.type === 'dropdown') { %>
          <select name="<%= field.name %>" id="<%= field.name %>">
            <% field.options.forEach(option => { %>
              <option value="<%= option %>" <%= field.value === option ? 'selected' : '' %>><%= option %></option>
            <% }) %>
          </select>
        <% } else if (field.type === 'radio') { %>
          <% field.options.forEach(option => { %>
            <input type="radio" name="<%= field.name %>" id="<%= field.name %>-<%= option %>" value="<%= option %>" <%= field.value === option ? 'checked' : '' %>>
            <label for="<%= field.name %>-<%= option %>"><%= option %></label>
          <% }) %>
        <% } else if (field.type === 'boolean') { %>
          <input type="radio" name="<%= field.name %>" id="<%= field.name %>-true" value="true" <%= field.value === 'true' ? 'checked' : '' %>>
          <label for="<%= field.name %>-true">True</label>
          <input type="radio" name="<%= field.name %>" id="<%= field.name %>-false" value="false" <%= field.value === 'false' ? 'checked' : '' %>>
          <label for="<%= field.name %>-false">False</label>
        <% } else if (field.type === 'array') { %>
          <% if (Array.isArray(field.value)) { %>
            <% field.value.forEach((item, index) => { %>
              <div class="array-field">
                <input type="text" name="<%= field.name %>[]"
                       id="<%= field.name %>-<%= index %>"
                       value="<%= item %>">
              </div>
            <% }); %>
          <% } else { %>
            <div class="array-field">
              <input type="text" name="<%= field.name %>[]"
                     id="<%= field.name %>-0"
                     value="<%= field.value %>">
            </div>
          <% } %>
          <button type="button" onclick="addArrayField('<%= field.name %>')">Add more</button>
        <% } else if (field.type === 'object') { %>
          <% for (const key in field.value) { %>
            <div class="object-field">
              <label for="<%= field.name %>_<%= key %>"><%= key %>:</label>
              <input type="text" name="<%= field.name %>[<%= key %>]"
                     id="<%= field.name %>_<%= key %>"
                     value="<%= field.value[key] %>">
            </div>
          <% } %>
        <% } else { %>
          <input type="<%= field.type %>" name="<%= field.name %>" id="<%= field.name %>" value="<%= field.value %>">
        <% } %>
      </div>
    <% }) %>
    <button type="submit">Submit</button>
  </form>

  <script>
    function addArrayField(name) {
      const container = document.querySelectorAll(`input[name="${name}[]"]`)[0].parentElement;
      const index = container.querySelectorAll(`input[name="${name}[]"]`).length;
      const newField = document.createElement('div');
      newField.className = 'array-field';
      newField.innerHTML = `<input type="text" name="${name}[]" id="${name}-${index}">`;
      container.appendChild(newField);
    }
  </script>
</body>
</html>
