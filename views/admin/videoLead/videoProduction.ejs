<!DOCTYPE html>
<html>
<head>
  <title>Video Production</title>
  <script src="/socket.io/socket.io.js"></script>
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
</head>
<body>
  <h1>Video Production</h1>

  <!-- Form to upload videos -->
  <form id="uploadForm" enctype="multipart/form-data">
    <label for="video">Upload Video:</label>
    <input type="file" id="video" name="video">
    <button type="submit">Upload</button>
  </form>

  <!-- Display uploaded videos -->
  <h2>Uploaded Videos</h2>
  <button class="collapsible">Get Videos<span class="carrot"></span></button>
  <div class="content" data-url="/videoProduction/getVideos"></div>
  <div id="videoList"></div>

  <!-- Schedule video push -->
  <h2>Schedule Video Push</h2>
  <button id="schedulePush">Schedule Video Push</button>

  <!-- View scheduled videos -->
  <h2>Scheduled Videos</h2>
  <div id="scheduledVideos"></div>

  <script>
    $(document).ready(function() {
      var socket = io('/videoProduction');

      // Handle video upload
      $('#uploadForm').on('submit', function(e) {
        e.preventDefault();
        var formData = new FormData();
        formData.append('video', $('#video')[0].files[0]);

        $.ajax({
          url: '/videoProduction/upload',
          type: 'POST',
          data: formData,
          processData: false,
          contentType: false,
          success: function(response) {
            alert('Video uploaded successfully!');
            socket.emit('newVideo', response.video);
          },
          error: function(err) {
            alert('Error uploading video');
          }
        });
      });

      // Listen for new videos
      socket.on('newVideo', function(video) {
        $('#videoList').append(`<div><img src="${video.thumbnail}" alt="Video Thumbnail"><p>${video.name}</p></div>`);
      });

      // Schedule video push
      $('#schedulePush').on('click', function() {
        socket.emit('scheduleVideoPush');
      });

      // Listen for scheduled videos
      socket.on('scheduledVideos', function(videos) {
        $('#scheduledVideos').empty();
        videos.forEach(function(video) {
          $('#scheduledVideos').append(`<div><img src="${video.thumbnail}" alt="Video Thumbnail"><p>${video.name}</p></div>`);
        });
      });
    });
  </script>
</body>
</html>
