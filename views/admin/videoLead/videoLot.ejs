

  <div class="container">
    <h1>Uploaded Videos</h1>
    <!-- Video list dynamically generated by the server -->
    <% videos.forEach(video => { %>
      <div class="video-card">
        <div class="video-title"><%= video.name %></div>
        <div class="video-upload-date">Uploaded on: <%= new Date(video.createdAt).toLocaleString() %></div>
        <button class="emit-viewers btn" data-video-url="<%= video.url %>">Play Video</button>
      </div>
    <% }); %>
  </div>

  <!-- Socket.io script -->
  <script src="/socket.io/socket.io.js"></script>
  <script>
    document.addEventListener('DOMContentLoaded', () => {
      console.log('DOM fully loaded and parsed ON VIDEOLOT.');

      const socket = io('/video_production');

      socket.on('connect', () => {
        console.log('Connected to video_production namespace.');
      });

      // Function to attach event listeners
      function attachEventListeners() {
        const playButtons = document.querySelectorAll('.emit-viewers');
        playButtons.forEach(button => {
          button.addEventListener('click', (event) => {
            const videoUrl = event.target.getAttribute('data-video-url');
            console.log('Play Video button clicked:', videoUrl);
            socket.emit('broadcast overlay', { videoUrl: videoUrl });
          });
        });
      }

      // Ensure event listeners are attached after a slight delay
      setTimeout(attachEventListeners, 100);
    });
  </script>

